extends layout
block content
    link(rel="stylesheet" href="/stylesheets/pages/question-page.css")
    div.content
        .question
            .question_header
                h1 #{question.title}
                .question_info
                    .question_info_item Asked: #{question.createdAt}
                    .question_info_item Updated: #{question.updatedAt}
            .post_layout
                .upper_container
                    .votes_container
                        if !votedOnQuestion && session.auth
                            button(id=`upvote-question-${question.id}` class = "upvote-question") Upvote
                        div#question-vote-count #{questionVoteCount}
                        if !votedOnQuestion && session.auth
                            button(id=`downvote-question-${question.id}` class = "downvote-question") Downvote
                    .message_container
                        p #{question.message}
                .comments_container
                    each comment in question.Comments
                        .comment
                            span.comment_message #{comment.message}
                            span.comment_author -#{comment.author}
                    .post_buttons
                        if session.auth
                            button(id=`answer-question-${question.id}` class="answer-question") Answer question
                            button(id=`comment-question-${question.Id}` class="comment-question") Comment on question
                            if session.auth.userId === question.userId
                                button(id=`delete-question-${question.id}` class="delete-question") Delete
                                button(id=`edit-question-${question.id}` class="edit-question-button") Edit
                    .post_forms
                        form#comment-form(action="/" method="post" style="display:none")
                            input(type="text" name="message" placeholder="message")
                            input#comment-submit(type="submit" value="submit")
                        form#answer-form(action="/" method="post" style="display:none")
                            input(type="text" name="message" placeholder="message")
                            input#answer-submit(type="submit" value="submit")
                        form#edit-form(action="/" method="post" style="display:none")
                            input#title(type="text" name="title" placeholder="title")
                            input#message(type="text" name="message" placeholder="message")
                            input#edit-submit(type="submit" value="submit")
        .answers
            .answer_header
                span Answers
            each answer in question.Answers
                .post_layout
                    .upper_container
                        .votes_container
                            if !votedAnswerIdsObject[answer.id] && session.auth
                                button(id=`upvote-answer-${answer.id}` class = "upvote-answer") Upvote
                            div#answer-vote-count #{answer.voteCount}
                            if !votedAnswerIdsObject[answer.id] && session.auth
                                button(id=`downvote-answer-${answer.id}` class = "downvote-answer") Downvote
                        .message_container
                            p #{answer.message}
                    .comments_container
                        each comment in answer.Comments
                            .comment
                                span.comment_message #{comment.message}
                                span.comment_author -#{comment.author}
                        .post_buttons
                            if session.auth
                                button(id=`comment-answer-${answer.id}` class="comment-answer") Comment on answer
                                if session.auth.userId === question.userId
                                    button(id=`delete-answer-${answer.id}` class="delete-answer") Delete
                                    button(id=`edit-answer-${answer.id}` class="edit-answer") Edit
                        .post_forms
                            form#answer-comment-form(action="/" method="post" style="display:none")
                                input(type="text" name="message" placeholder="message")
                                input#answer-comment-submit(type="submit" value="submit")

    div(id=`question-author-${question.id}`)=question.author
    div#title=question.title
    div#message=question.message
    div(id=`question-vote-count-${question.id}`)=questionVoteCount
    ul#errors
    form#edit-form(action="/" method="post" style="display:none")
        input#title(type="text" name="title" placeholder="title")
        input#message(type="text" name="message" placeholder="message")
        input#edit-submit(type="submit" value="submit")
    form#comment-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#comment-submit(type="submit" value="submit")
    form#answer-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#answer-submit(type="submit" value="submit")
    form#answer-comment-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#answer-comment-submit(type="submit" value="submit")
    form#edit-answer-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#edit-answer-submit(type="submit" value="submit")
    ul.answers
        each answer in question.Answers
            li(id=`answer-${answer.id}`)
                div(id=`answer-author-${answer.id}`)=answer.author
                div(id=`answer-message-${answer.id}`)=answer.message
                div(id=`answer-vote-count-${answer.id}` class='answer-vote-count')=answer.voteCount
                if session.auth
                    button(id=`comment-answer-${answerId}` class="comment-answer") Comment
                    if !votedAnswerIdsObject[answer.id]
                        button(id=`upvote-answer-${answer.id}` class = "upvote-answer") Upvote
                        button(id=`downvote-answer-${answer.id}` class = "downvote-answer") Downvote
                    if session.auth.userId === answer.userId
                        button(id=`delete-answer-${answer.id}` class="delete-answer") Delete
                        button(id=`edit-answer-${answer.id}` class="edit-answer") Edit
                ul(id = `answer-comments-${answer.id}` class = "answer-comments")
                    each comment in answer.Comments
                        li(id=`comment-${comment.id}`)
                            div(id=`comment-author-${comment.id}`)=comment.author
                            div(id=`comment-message-${comment.id}`)=comment.message
                            if session.auth && session.auth.userId === comment.userId
                                button(id=`delete-comment-${comment.id}` class="delete-comment") Delete
                                button(id=`edit-comment-${comment.id}` class="edit-comment") Edit

    form#edit-comment-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#edit-comment-submit(type="submit" value="submit")
    ul.comments
        each Comment in question.Comments
            li(id=`comment-${Comment.id}`)
                div(id=`comment-author-${Comment.id}`)=Comment.author
                div(id=`comment-message-${Comment.id}`)=Comment.message
                if session.auth && session.auth.userId === Comment.userId
                    button(id=`delete-comment-${Comment.id}` class="delete-comment") Delete
                    button(id=`edit-comment-${Comment.id}` class="edit-comment") Edit
    div(id=`question-author-${question.id}`)=question.author
    div#title=question.title
    div#message=question.message
    div(id=`question-vote-count-${question.id}`)=questionVoteCount
    ul#errors
    form#edit-form(action="/" method="post" style="display:none")
        input#title(type="text" name="title" placeholder="title")
        input#message(type="text" name="message" placeholder="message")
        input#edit-submit(type="submit" value="submit")
    form#comment-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#comment-submit(type="submit" value="submit")
    form#answer-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#answer-submit(type="submit" value="submit")
    form#answer-comment-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#answer-comment-submit(type="submit" value="submit")
    form#edit-answer-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#edit-answer-submit(type="submit" value="submit")
    ul.answers
        each answer in question.Answers
            li(id=`answer-${answer.id}`)
                div(id=`answer-author-${answer.id}`)=answer.author
                div(id=`answer-message-${answer.id}`)=answer.message
                div(id=`answer-vote-count-${answer.id}` class='answer-vote-count')=answer.voteCount
                if session.auth
                    button(id=`comment-answer-${answer.id}` class="comment-answer") Comment
                    if !votedAnswerIdsObject[answer.id]
                        button(id=`upvote-answer-${answer.id}` class = "upvote-answer") Upvote
                        button(id=`downvote-answer-${answer.id}` class = "downvote-answer") Downvote
                    if session.auth && session.auth.userId === answer.userId
                        button(id=`delete-answer-${answer.id}` class="delete-answer") Delete
                        button(id=`edit-answer-${answer.id}` class="edit-answer") Edit
    form#edit-comment-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#edit-comment-submit(type="submit" value="submit")
    ul.comments
        each Comment in question.Comments
            li(id=`comment-${Comment.id}`)
                div(id=`comment-author-${Comment.id}`)=Comment.author
                div(id=`comment-message-${Comment.id}`)=Comment.message
                if session.auth && session.auth.userId === Comment.userId
                    button(id=`delete-comment-${Comment.id}` class="delete-comment") Delete
                    button(id=`edit-comment-${Comment.id}` class="edit-comment") Edit
    div(id=`question-author-${question.id}`)=question.author
    div#title=question.title
    div#message=question.message
    div(id=`question-vote-count-${question.id}`)=questionVoteCount
    ul#errors
    form#edit-form(action="/" method="post" style="display:none")
        input#title(type="text" name="title" placeholder="title")
        input#message(type="text" name="message" placeholder="message")
        input#edit-submit(type="submit" value="submit")
    form#comment-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#comment-submit(type="submit" value="submit")
    form#answer-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#answer-submit(type="submit" value="submit")
    form#answer-comment-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#answer-comment-submit(type="submit" value="submit")
    form#edit-answer-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#edit-answer-submit(type="submit" value="submit")
    ul.answers
        each answer in question.Answers
            li(id=`answer-${answer.id}`)
                div(id=`answer-author-${answer.id}`)=answer.author
                div(id=`answer-message-${answer.id}`)=answer.message
                div(id=`answer-vote-count-${answer.id}` class='answer-vote-count')=answer.voteCount
                if session.auth
                    button(id=`comment-answer-${answer.id}` class="comment-answer") Comment
                    if !votedAnswerIdsObject[answer.id]
                        button(id=`upvote-answer-${answer.id}` class = "upvote-answer") Upvote
                        button(id=`downvote-answer-${answer.id}` class = "downvote-answer") Downvote
                    if session.auth.userId === answer.userId
                        button(id=`delete-answer-${answer.id}` class="delete-answer") Delete
                        button(id=`edit-answer-${answer.id}` class="edit-answer") Edit
                ul(id = `answer-comments-${answer.id}` class = "answer-comments")
                    each comment in answer.Comments
                        li(id=`comment-${comment.id}`)
                            div(id=`comment-author-${comment.id}`)=comment.author
                            div(id=`comment-message-${comment.id}`)=comment.message
                            if session.auth && session.auth.userId === comment.userId
                                button(id=`delete-comment-${comment.id}` class="delete-comment") Delete
                                button(id=`edit-comment-${comment.id}` class="edit-comment") Edit

    form#edit-comment-form(action="/" method="post" style="display:none")
        input(type="text" name="message" placeholder="message")
        input#edit-comment-submit(type="submit" value="submit")
    ul.comments
        each comment in question.Comments
            li(id=`comment-${comment.id}`)
                div(id=`comment-author-${comment.id}`)=comment.author
                div(id=`comment-message-${comment.id}`)=comment.message
                if session.auth && session.auth.userId === comment.userId
                    button(id=`delete-comment-${comment.id}` class="delete-comment") Delete
                    button(id=`edit-comment-${comment.id}` class="edit-comment") Edit

    //- if session.auth
    //-     div
    //-         button(id=`answer-question-${question.id}` class="answer-question") Answer
    //-         button(id=`comment-question-${question.id}` class="comment-question") Comment
    //-         if session.auth && !votedOnQuestion
    //-             button(id=`upvote-question-${question.id}` class = "upvote-question") Upvote
    //-             button(id=`downvote-question-${question.id}` class = "downvote-question") Downvote
    //-         if session.auth && session.auth.userId === question.userId
    //-             button(id=`delete-question-${question.id}` class="delete-question") Delete
    //-             button(id=`edit-question-${question.id}` class="edit-question-button") Edit

    script(src='../javascripts/index.js' type='module')
